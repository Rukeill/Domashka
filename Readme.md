# Развертывание стека ELK в Kubernetes

## 1. Предварительные требования

Для успешного развертывания проекта целевой кластер Kubernetes должен соответствовать следующим спецификациям:

| Требование | Спецификация | 
| :--- | :--- |
| **Версия Kubernetes** | 1.34 
| **Сетевой доступ** | Интернет и Docker Hub | 
| **Класс хранилища** | `csi-driver-lvm-linear` |


### 2. Требования к ресурсам

Распределение ресурсов для основных компонентов определено в манифестах Kubernetes. 

| Компонент | CPU (Запрос/Лимит) | Память (Запрос/Лимит) |
| :--- | :--- | :--- |
| **Elasticsearch** | 1 cpu | 2Gi |
| **Kibana** | 1 cpu | 2Gi|
| **Filebeat** | 0.1/1 cpu | 100/200 Mb |


## 3. Развертывание

Все манифесты Kubernetes расположены в директории `deploy/`. 

**Время развертывания:** Полное развертывание стека, включая выделение Persistent Volumes, обычно занимает около **4 минут** до полной готовности к работе.

Для развертывания проекта выполните следующую команду:

```bash
kubectl apply -f deploy/
```

## 4. Детали сбора логов

**Filebeat** развернут как `DaemonSet`. Он настроен на сбор логов из следующих критически важных мест:

*   **Системные логи:** `/var/log` 
*   **Аудит-логи Kubernetes:** `/var/log/kubernetes` 

## 5. Доступ к Kibana

Доступ к дашборду Kibana предоставляется через объект **Ingress**, который открыт через сервис `NodePort`.

| Деталь | Значение |
| :--- | :--- |
| **Хост доступа** | `kibana.local` |
| **Тип доступа** | Ingress через NodePort |
| **Порт для обращения к ingress** | 30080 |

### Учетные данные

Учетные данные для суперпользователя `elastic` хранятся в Kubernetes Secret.

**Чтобы получить пароль:**

1.  Найдите Secret, содержащий учетные данные (например, `elasticsearch-master-credentials`).
2.  Декодируйте поле `password` из Base64.

```bash

kubectl get secret -n elk elasticsearch-master-credentials -o jsonpath='{.data.password}' | base64 --decode && echo
```

Используйте имя пользователя `elastic` и полученный пароль для входа в интерфейс Kibana.

